<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Scripts</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts - Roboto for a professional look -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Carga de Tailwind CSS desde CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Enlace a tu archivo de estilos personalizado (si tienes uno) -->
    <!-- <link rel="stylesheet" href="style.css"> -->
   
</head>
<body>
    <div class="layout">
        <nav class="sidebar">
                <h2>Reportes</h2>
                <ul>
                    <li><button class="sidebar-link" data-section="mos">MOS</button></li>
                    <li><button class="sidebar-link" data-section="gs">Gere Solped</button></li>
                    <li><button class="sidebar-link" data-section="dispo">Disponibilidad Futura</button></li>
                    <li><button class="sidebar-link" data-section="gc">Gere Comex</button></li>
                    <li><button class="sidebar-link" data-section="fe">Forecast Error</button></li>
                    <li><button class="sidebar-link" data-section="lc">Land Cost</button></li>
                    <li class="sidebar-manuales-item"><button class="sidebar-link sidebar-manuales-link" data-section="manuales">Manuales</button></li>
                    <!-- Agrega más secciones si lo deseas -->
                </ul>
        </nav>
        <div class="center-wrapper">
            <section class="cuadro center-section" id="section-mos">
                <div class="seccion-1 titulo">
                    <h1>Tratamiento bases MOS</h1>
                    <form action="" class="form">
                        <label for="reportSelect">Selecciona un reporte:</label>
                        <select id="reportSelect" class="dropdown">
                            <option value="scriptA">Forecast</option>
                            <option value="scriptB">Ventas</option>
                            <option value="scriptC">MARA</option>
                        </select>
                    </form>


                    <div class="manual-link-wrapper">
                

                    
                </div>

                <div class="botones">
                    <button class="script-button scriptA-button" data-script="1">Mainstream</button>
                    <button class="script-button scriptA-button" data-script="2">AXS</button>
                    <button class="script-button scriptA-button" data-script="3">Premium</button>
                    <button class="script-button scriptA-button" data-script="4">Consolidación</button>

                    <!-- Botones para Script B (inicialmente ocultos) -->
                    <button class="script-button scriptB-button hidden" data-script="5">Mainstream</button>
                    <button class="script-button scriptB-button hidden" data-script="6">AXS</button>
                    <button class="script-button scriptB-button hidden" data-script="7">Premium</button>
                    <button class="script-button scriptB-button hidden" data-script="8">Consolidación</button>

                    <!-- Botones para Script C (inicialmente ocultos) -->
                    <button class="script-button scriptC-button hidden" data-script="9">Consolidar MARA</button>
                  
                </div>
                <div class="manual-link-wrapper">
                    <a href="https://inchcapeuk.sharepoint.com/:w:/r/sites/PlanificacionyComprasCL/Documentos%20compartidos/Planificacion%20y%20Compras%20Procesos%20y%20Metodos/Procedimientos%20y%20Estandar%20Procesos%20y%20Metodos/Procedimiento%20de%20Preparaci%C3%B3n%20y%20Actualizaci%C3%B3n%20Panel%20MOS.docx?d=w1107c516488e48358f0c143a52fb25d8&csf=1&web=1&e=xlXaCU" target="_blank" class="manual-link">Manual de Uso MOS</a>
                </div>
                
                
            </section>
                
            <section  class="cuadro center-section hidden" id="section-gs">
                <div class="seccion-2">
                    <h1>Gere Solped</h1>
                </div>

                <div class="botones gs-botones">
                    <div class="gs-row">
                        <button class="script-button" data-script="GS1">Descarga VMP</button>
                        <button class="script-button" data-script="GS2">Descarga INP</button>
                    </div>
                    <button class="script-button gs-bottom" data-script="GS3">Consolidación</button>   
                </div>
                <div class="manual-link-wrapper">
                        <a href="https://inchcapeuk.sharepoint.com/:w:/r/sites/PlanificacionyComprasCL/Documentos%20compartidos/Planificacion%20y%20Compras%20Procesos%20y%20Metodos/Procedimientos%20y%20Estandar%20Procesos%20y%20Metodos/Procedimiento%20de%20Preparaci%C3%B3n%20y%20Actualizaci%C3%B3n%20Panel%20MOS.docx?d=w1107c516488e48358f0c143a52fb25d8&csf=1&web=1&e=xlXaCU" target="_blank" class="manual-link">Manual de Uso Gere Solped</a>
                </div>
            
            </section>
               

            
        <!-- ...contenido de Gere Solped... -->
            <section class="cuadro center-section section-dispo hidden" id="section-dispo">
                <div class="seccion-3 titulo">
                    <h1>Disponibilidad Futura</h1>
                    <form action="" class="form">
                        <label for="reportSelect">Selecciona Legacy:</label>
                        <select id="reportSelectDf" class="dropdown">
                            <option value="scriptdfOem">OEM</option>
                            <option value="scriptdfAxs">AXS</option>
                            <option value="scriptdfInp">Inchcape</option>
                            <option value="scriptdfDitec">Ditec</option>
                        </select>
                    </form>
                </div>

                <div class="botones">
                    <button class="script-button scriptdfOem-button" data-script="dfOem">DF OEM</button>
                    <button class="script-button scriptdfAxs-button hidden" data-script="dfAxs">DF AXS</button>
                    <button class="script-button scriptdfInp-button hidden" data-script="dfInp">DF Inchcape</button>
                    <button class="script-button scriptdfDitec-button hidden" data-script="dfDitec">DF Ditec</button>

                    <!-- Botones para Script B (inicialmente ocultos) -->
  
                </div>
                <div class="manual-link-wrapper">
                    <a href="https://inchcapeuk.sharepoint.com/:w:/r/sites/PlanificacionyComprasCL/Documentos%20compartidos/Planificacion%20y%20Compras%20Procesos%20y%20Metodos/Procedimientos%20y%20Estandar%20Procesos%20y%20Metodos/Procedimiento%20de%20Preparaci%C3%B3n%20y%20Actualizaci%C3%B3n%20Panel%20MOS.docx?d=w1107c516488e48358f0c143a52fb25d8&csf=1&web=1&e=xlXaCU" target="_blank" class="manual-link">Manual de Uso Disponibilidad Futura</a>
                </div>

                
            </section>
            <section  class="cuadro center-section hidden" id="section-gc">
                <div class="seccion-2">
                    <h1>Gere Comex</h1>
                </div>

                <div class="botones gc-botones">
                    <div class="gc-row">
                        <button class="script-button" data-script="GC1">Descargas SAP</button>
                    </div>   
                </div>
            
            </section>

            <section  class="cuadro center-section hidden" id="section-fe">
                <div class="seccion-3 titulo">
                    <h1>Forecast Error</h1>
                    <form action="" class="form">
                        <label for="reportSelectFe">Selecciona un reporte:</label>
                        <select id="reportSelectFe" class="dropdown">
                            <option value="scriptFeOem">FE OEM</option>
                            <option value="scriptUnirBases">Unir Bases</option>
                            <option value="scriptFePremium">FE Premium</option>
                        </select>
                    </form>
                </div>

                <div class="botones">
                    <button class="script-button scriptFeOem-button" data-script="feOem">FE OEM</button>
                    <button class="script-button scriptFePremium-button hidden" data-script="fePremium">FE Premium</button>
                    <button class="script-button scriptUnirBases-button hidden" data-script="unirBases">Unir Bases</button>
                </div>
            
            </section>

            <section class="cuadro center-section hidden" id="section-manuales">
                <div class="seccion-manuales titulo">
                    <h1>Manuales de Usuario</h1>
                </div>
                <div class="manuales-links flex flex-col space-y-4 p-4">
                    <div class="manual-link-wrapper">
                        <a href="https://ejemplo.com/manual_mos.docx" target="_blank" class="manual-link">Manual de MOS</a>
                    </div>
                    <a href="https://ejemplo.com/manual_disponibilidad_futura.docx" target="_blank" class="text-blue-600 hover:underline">Manual de Disponibilidad Futura</a>
                    <!-- Agrega más enlaces a tus manuales aquí, asegurándote de usar las URLs reales de tus documentos de Word en línea. -->
                    <p class="text-sm text-gray-500 mt-4">Nota: Estos son enlaces de ejemplo. Reemplázalos con las URLs reales de tus documentos de Word en línea.</p>
                </div>
            </section>
            <section  class="cuadro center-section hidden" id="section-lc">
                <div class="seccion-2">
                    <h1>Land Cost</h1>
                </div>

                <div class="botones lc-botones">
                    <div class="lc-row">
                        <button class="script-button" data-script="lc1">Extraer Fletes</button>
                        <button class="script-button" data-script="lc2">Ejecutar Land Cost</button>
                        <button class="script-button" data-script="lc3">Consolidar Land Cost</button>
                    </div>
                </div>
                <div class="manual-link-wrapper">
                        <a href="https://inchcapeuk.sharepoint.com/:w:/r/sites/PlanificacionyComprasCL/Documentos%20compartidos/Planificacion%20y%20Compras%20Procesos%20y%20Metodos/Procedimientos%20y%20Estandar%20Procesos%20y%20Metodos/Procedimiento%20de%20Preparaci%C3%B3n%20y%20Actualizaci%C3%B3n%20Panel%20MOS.docx?d=w1107c516488e48358f0c143a52fb25d8&csf=1&web=1&e=xlXaCU" target="_blank" class="manual-link">Manual de Uso Land Cost</a>
                </div>
        
            </section>
        </div>
    </div>
    <script>
        // 1. Referencias a elementos del DOM
        // Referencias generales
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        const centerSections = document.querySelectorAll('.center-section');
        // const outputConsole = document.getElementById('outputConsole'); // Descomentar si tienes un elemento con id="outputConsole"

        // Referencias para la sección MOS
        const reportSelect = document.getElementById('reportSelect');
        const scriptAButtons = document.querySelectorAll('.scriptA-button');
        const scriptBButtons = document.querySelectorAll('.scriptB-button');
        const scriptCButtons = document.querySelectorAll('.scriptC-button');

        // Referencias para la sección Disponibilidad Futura
        const reportSelectDf = document.getElementById('reportSelectDf');
        const scriptdfOemButtons = document.querySelectorAll('.scriptdfOem-button');
        const scriptdfAxsButtons = document.querySelectorAll('.scriptdfAxs-button');
        const scriptdfInpButtons = document.querySelectorAll('.scriptdfInp-button');
        const scriptdfDitecButtons = document.querySelectorAll('.scriptdfDitec-button');

        // Referencias para la sección Forecast Error
        const reportSelectFe = document.getElementById('reportSelectFe');
        const scriptFeOemButtons = document.querySelectorAll('.scriptFeOem-button');
        const scriptUnirBasesButtons = document.querySelectorAll('.scriptUnirBases-button');
        const scriptFePremiumButtons = document.querySelectorAll('.scriptFePremium-button');

        // 2. Funciones para actualizar la interfaz de usuario

        // Función para mostrar/ocultar botones en la sección MOS
        function updateButtons() {
            const selectedValue = reportSelect.value;

            // Ocultar todos los botones primero
            scriptAButtons.forEach(button => button.classList.add('hidden'));
            scriptBButtons.forEach(button => button.classList.add('hidden'));
            scriptCButtons.forEach(button => button.classList.add('hidden'));

            // Mostrar los botones según la opción seleccionada
            if (selectedValue === 'scriptA') {
                scriptAButtons.forEach(button => button.classList.remove('hidden'));
            } else if (selectedValue === 'scriptB') {
                scriptBButtons.forEach(button => button.classList.remove('hidden'));
            } else if (selectedValue === 'scriptC') {
                scriptCButtons.forEach(button => button.classList.remove('hidden'));
            }
        }

        // Función para mostrar/ocultar botones en Disponibilidad Futura
        function updateDfButtons() {
            const selectedValue = reportSelectDf.value;

            // Oculta todos los botones primero
            scriptdfOemButtons.forEach(btn => btn.classList.add('hidden'));
            scriptdfAxsButtons.forEach(btn => btn.classList.add('hidden'));
            scriptdfInpButtons.forEach(btn => btn.classList.add('hidden'));
            scriptdfDitecButtons.forEach(btn => btn.classList.add('hidden'));
            
            // Muestra solo los botones correspondientes
            if (selectedValue === 'scriptdfOem') {
                scriptdfOemButtons.forEach(btn => btn.classList.remove('hidden'));
            } else if (selectedValue === 'scriptdfAxs') {
                scriptdfAxsButtons.forEach(btn => btn.classList.remove('hidden'));
            } else if (selectedValue === 'scriptdfInp') {
                scriptdfInpButtons.forEach(btn => btn.classList.remove('hidden'));
            } else if (selectedValue === 'scriptdfDitec') { // Corregido: 'scriptdfDitec' en lugar de 'scriptdfDitecButtons'
                scriptdfDitecButtons.forEach(btn => btn.classList.remove('hidden'));
            }
        }

        // Función para mostrar/ocultar botones en Forecast Error
        function updateFeButtons() {
            const selectedValue = reportSelectFe.value;

            // Oculta todos los botones primero
            scriptFeOemButtons.forEach(btn => btn.classList.add('hidden'));
            scriptUnirBasesButtons.forEach(btn => btn.classList.add('hidden'));
            scriptFePremiumButtons.forEach(btn => btn.classList.add('hidden'));
            
            // Muestra solo los botones correspondientes
            if (selectedValue === 'scriptFeOem') {
                scriptFeOemButtons.forEach(btn => btn.classList.remove('hidden'));
            } else if (selectedValue === 'scriptUnirBases') {
                scriptUnirBasesButtons.forEach(btn => btn.classList.remove('hidden'));
            } else if (selectedValue === 'scriptFePremium') {
                scriptFePremiumButtons.forEach(btn => btn.classList.remove('hidden'));
            }
        }

        // 3. Manejadores de eventos

        // Event listener para el select de la sección MOS
        reportSelect.addEventListener('change', updateButtons);

        // Event listener para el select de Disponibilidad Futura
        if (reportSelectDf) { // Se verifica si el elemento existe antes de añadir el listener
            reportSelectDf.addEventListener('change', updateDfButtons);
        }

        // Event listener para el select de Forecast Error
        if (reportSelectFe) { // Se verifica si el elemento existe antes de añadir el listener
            reportSelectFe.addEventListener('change', updateFeButtons);
        }

        // Navegación de la barra lateral para mostrar la sección correspondiente
        sidebarLinks.forEach(btn => {
            btn.addEventListener('click', function() {
                // Quita la clase activa de todos
                sidebarLinks.forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // Oculta todas las secciones centrales
                centerSections.forEach(sec => sec.classList.add('hidden'));

                // Muestra la sección correspondiente
                const section = this.getAttribute('data-section');
                document.getElementById('section-' + section).classList.remove('hidden');
            });
        });

        // Manejo del click en los botones de script
        document.querySelectorAll('.script-button').forEach(button => {
            button.addEventListener('click', () => {
                const scriptId = button.getAttribute('data-script');
                // let nombreScript = ''; // Esta variable no se usa, se puede eliminar o usar para logging
                // if (scriptId === '1') nombreScript = 'fc_consolidado_mainstream.py';
                // else if (scriptId === '2') nombreScript = 'script2.py';
                // ...agrega más si tienes otros scripts...

                if (typeof pywebview !== 'undefined' && pywebview.api && pywebview.api.execute_script) {
                    pywebview.api.execute_script(scriptId);
                }
                // No alerts, solo ejecuta el script
            });
        });

        // 4. Inicialización al cargar la página
        window.addEventListener('DOMContentLoaded', () => {
            // Activa la primera sección de la barra lateral al cargar
            const initialSidebarLink = document.querySelector('.sidebar-link[data-section="mos"]');
            if (initialSidebarLink) {
                initialSidebarLink.classList.add('active');
                document.getElementById('section-mos').classList.remove('hidden');
            }

            // Llama a las funciones de actualización para establecer el estado inicial correcto de los botones
            updateButtons();
            if (reportSelectDf) updateDfButtons();
            if (reportSelectFe) updateFeButtons();
        });

        // Funciones para la consola de salida (comentadas)
        // function appendOutput(message) {
        //     const p = document.createElement('p');
        //     p.textContent = message;
        //     outputConsole.appendChild(p);
        //     outputConsole.scrollTop = outputConsole.scrollHeight;
        // }
        // Función para limpiar la consola de salida
        // function clearOutput() {
        //     outputConsole.innerHTML = '';
        // }
    </script>
</body>
</html>